<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Building a Robust Error Handling System for AWS AppSync APIs with Appsync JS Resolvers | Vishnu Prasad</title>
<meta name="keywords" content="aws, serverless, appsync, lambda, error, error handling, appsync error handling, aws appsync, best practice, appsync error handling best practices">
<meta name="description" content="Introduction If you&rsquo;ve built REST APIs with AWS API Gateway, you know how nice it is to return structured error responses with proper HTTP status codes, error types, and detailed context. Then you switch to GraphQL with AppSync, and suddenly your beautiful error handling becomes&hellip; generic.
{ &#34;errors&#34;: [{ &#34;message&#34;: &#34;Error&#34; }] } That&rsquo;s it. No error types. No structured context. Just a string.
This doesn&rsquo;t have to be the case.">
<meta name="author" content="Vishnu Prasad">
<link rel="canonical" href="https://vishnuprasad.blog/posts/appsync-error-handling/">
<meta name="google-site-verification" content="G-2GF369X3PK">
<link crossorigin="anonymous" href="https://vishnuprasad.blog/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css" integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z&#43;V9&#43;cO1A=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://vishnuprasad.blog/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://vishnuprasad.blog/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://vishnuprasad.blog/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://vishnuprasad.blog/apple-touch-icon.png">
<link rel="mask-icon" href="https://vishnuprasad.blog/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://vishnuprasad.blog/posts/appsync-error-handling/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
  
    
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-2GF369X3PK"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-2GF369X3PK');
        }
      </script>
    
  

<meta property="og:title" content="Building a Robust Error Handling System for AWS AppSync APIs with Appsync JS Resolvers" />
<meta property="og:description" content="Introduction If you&rsquo;ve built REST APIs with AWS API Gateway, you know how nice it is to return structured error responses with proper HTTP status codes, error types, and detailed context. Then you switch to GraphQL with AppSync, and suddenly your beautiful error handling becomes&hellip; generic.
{ &#34;errors&#34;: [{ &#34;message&#34;: &#34;Error&#34; }] } That&rsquo;s it. No error types. No structured context. Just a string.
This doesn&rsquo;t have to be the case." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://vishnuprasad.blog/posts/appsync-error-handling/" />
<meta property="og:image" content="https://vishnuprasad.blog/papermod-cover.png" />
<meta property="article:section" content="posts" />
<meta property="article:published_time" content="2025-11-23T18:30:00+00:00" />
<meta property="article:modified_time" content="2025-11-23T18:30:00+00:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://vishnuprasad.blog/papermod-cover.png" />
<meta name="twitter:title" content="Building a Robust Error Handling System for AWS AppSync APIs with Appsync JS Resolvers"/>
<meta name="twitter:description" content="Introduction If you&rsquo;ve built REST APIs with AWS API Gateway, you know how nice it is to return structured error responses with proper HTTP status codes, error types, and detailed context. Then you switch to GraphQL with AppSync, and suddenly your beautiful error handling becomes&hellip; generic.
{ &#34;errors&#34;: [{ &#34;message&#34;: &#34;Error&#34; }] } That&rsquo;s it. No error types. No structured context. Just a string.
This doesn&rsquo;t have to be the case."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://vishnuprasad.blog/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Building a Robust Error Handling System for AWS AppSync APIs with Appsync JS Resolvers",
      "item": "https://vishnuprasad.blog/posts/appsync-error-handling/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Building a Robust Error Handling System for AWS AppSync APIs with Appsync JS Resolvers",
  "name": "Building a Robust Error Handling System for AWS AppSync APIs with Appsync JS Resolvers",
  "description": "Introduction If you\u0026rsquo;ve built REST APIs with AWS API Gateway, you know how nice it is to return structured error responses with proper HTTP status codes, error types, and detailed context. Then you switch to GraphQL with AppSync, and suddenly your beautiful error handling becomes\u0026hellip; generic.\n{ \u0026#34;errors\u0026#34;: [{ \u0026#34;message\u0026#34;: \u0026#34;Error\u0026#34; }] } That\u0026rsquo;s it. No error types. No structured context. Just a string.\nThis doesn\u0026rsquo;t have to be the case.",
  "keywords": [
    "aws", "serverless", "appsync", "lambda", "error", "error handling", "appsync error handling", "aws appsync", "best practice", "appsync error handling best practices"
  ],
  "articleBody": "Introduction If you‚Äôve built REST APIs with AWS API Gateway, you know how nice it is to return structured error responses with proper HTTP status codes, error types, and detailed context. Then you switch to GraphQL with AppSync, and suddenly your beautiful error handling becomes‚Ä¶ generic.\n{ \"errors\": [{ \"message\": \"Error\" }] } That‚Äôs it. No error types. No structured context. Just a string.\nThis doesn‚Äôt have to be the case.\nIn this post, I‚Äôll show you how to bring API Gateway-style error handling to your GraphQL APIs using AppSync JavaScript resolvers and custom exception classes. We‚Äôll transform generic GraphQL errors into structured, type-safe responses that your clients can actually use.\nBy the end, you‚Äôll have:\nCustom exception classes with type-safe context Middleware that automatically transforms errors AppSync JS resolvers that propagate structured errors Client-friendly error responses that rival REST APIs All with real, production-ready code you can implement today.\nThe Problem: GraphQL‚Äôs Generic Error Responses If you‚Äôve worked with REST APIs and AWS API Gateway, you‚Äôre probably familiar with structured error responses:\n// REST API error response (what we want) { \"statusCode\": 400, \"errorType\": \"ValidationException\", \"message\": \"Invalid email format\", \"errorInfo\": { \"field\": \"email\", \"constraint\": \"email\", \"receivedValue\": \"not-an-email\" } } This is great! The client knows exactly what went wrong, which field failed validation, and why.\nNow let‚Äôs look at what you typically get with GraphQL/AppSync when using generic error handling:\n// Generic GraphQL error (what we're replacing) { \"data\": null, \"errors\": [ { \"message\": \"Error\", \"path\": [\"getUser\"], \"locations\": [{ \"line\": 2, \"column\": 3 }] } ] } See the problem? You lose all that rich context. No error types, no additional information, just a vague message.\nWhy This Happens When you throw errors in Lambda and don‚Äôt handle them properly:\n// The problematic approach export const handler = async (event) =\u003e { try { const user = await database.getUser(id); } catch (error) { // This becomes a generic GraphQL error throw new Error('Something went wrong'); } }; AppSync receives the raw error and converts it to a generic GraphQL error. You lose:\nError types: Can‚Äôt differentiate between validation, auth, or server errors Structured context: No field names, constraint information, or additional data Client actionability: Frontend can‚Äôt handle different error scenarios appropriately Type safety: No TypeScript interfaces, just string messages Debugging context: Production errors are nearly impossible to diagnose What We‚Äôre Building Our goal is to bring API Gateway-style error handling to GraphQL using:\nCustom exception classes (replacing generic Error objects) Middleware-based transformation (converting exceptions to structured responses) AppSync JS resolvers (propagating structured errors through GraphQL) Type-safe error schemas (making errors as reliable as successful responses) The result? GraphQL errors that look like this:\n{ \"data\": null, \"errors\": [ { \"message\": \"Invalid email format\", \"errorType\": \"VALIDATION_EXCEPTION\", \"errorInfo\": { \"field\": \"email\", \"constraint\": \"email\", \"receivedValue\": \"not-an-email\" }, \"path\": [\"getUser\"], \"locations\": [{ \"line\": 2, \"column\": 3 }] } ] } Now we have the best of both worlds: GraphQL‚Äôs query flexibility with REST API‚Äôs structured error responses.\nüìå TL;DR: We‚Äôre replacing generic GraphQL errors with API Gateway-style structured responses by:\nUsing custom exception classes instead of generic Error objects Transforming exceptions to response objects via middleware Using AppSync JS resolvers to propagate the structure through GraphQL‚Äôs util.error() Result: Clients get the same rich error context they‚Äôd expect from a REST API.\nOur Solution: A Three-Layer Approach Our error handling system operates across three distinct layers:\nLayer 1: Lambda (Where Errors Originate) This is where your business logic lives and where most errors occur. We use:\nCustom exception classes for type-safe error creation Middy middleware to intercept and transform errors Structured error responses that flow to AppSync Layer 2: AppSync (Error Transformation) AppSync sits between your Lambda functions and clients, transforming errors into GraphQL-compliant responses:\nJavaScript resolvers detect error responses Built-in utilities create proper GraphQL errors Automatic enrichment adds path and location information Layer 3: Client (Error Consumption) Your frontend receives structured errors that are easy to handle:\nType-safe error interfaces in TypeScript Centralized error handling logic User-friendly error messages The Complete Flow Here‚Äôs how an error travels through the system:\n1Ô∏è‚É£ Lambda Handler throw new ValidationException('Invalid email', { field: 'email' }) ‚Üì 2Ô∏è‚É£ Middy Middleware Catches exception ‚Üí Returns structured response { errorMessage: '...', errorType: '...', errorInfo: {...} } ‚Üì 3Ô∏è‚É£ AppSync JS Resolver Detects error response ‚Üí Calls util.error() Transforms to GraphQL error format ‚Üì 4Ô∏è‚É£ GraphQL Response { \"errors\": [{ \"message\": \"Invalid email\", \"errorType\": \"VALIDATION_EXCEPTION\", \"errorInfo\": { \"field\": \"email\" } }] } ‚Üì 5Ô∏è‚É£ Client Receives structured error ‚Üí Shows appropriate UI Key insight: We never let AppSync see a thrown error. We always return structured response objects that the JS resolver transforms into GraphQL errors with full context.\nLet‚Äôs build each layer.\nBuilding Custom Exception Classes First, we create a base exception class that all our custom errors will extend:\nexport class CustomException\u003cTInfo extends Record\u003cstring, unknown\u003e | null = null\u003e extends Error { readonly info: TInfo | null; constructor(message: string, info: TInfo | null = null) { super(message); this.info = info; Error.captureStackTrace(this, this.constructor); } } The magic here is the generic TInfo parameter. This lets us attach type-safe context to any error:\n// Define what information this error carries interface UserValidationError { field: string; constraint: string; receivedValue: unknown; allowedValues?: string[]; } // Throw with type-safe context throw new ValidationException\u003cUserValidationError\u003e('Invalid user role', { field: 'role', constraint: 'enum', receivedValue: 'super_admin', allowedValues: ['user', 'admin', 'moderator'], }); TypeScript now knows exactly what‚Äôs in error.info‚Äîno guessing, no casting.\nThe Four Exception Types We define four core exception types that cover most scenarios:\n// 1. ValidationException - Bad input from client export class ValidationException\u003cTInfo extends Record\u003cstring, unknown\u003e | null = null\u003e extends CustomException\u003cTInfo\u003e {} // 2. UnauthorizedException - Missing or invalid auth export class UnauthorizedException\u003cTInfo extends Record\u003cstring, unknown\u003e | null = null\u003e extends CustomException\u003cTInfo\u003e {} // 3. ForbiddenException - Valid auth but insufficient permissions export class ForbiddenException\u003cTInfo extends Record\u003cstring, unknown\u003e | null = null\u003e extends CustomException\u003cTInfo\u003e {} // 4. InternalServiceError - Server-side failures export class InternalServiceError\u003cTInfo extends Record\u003cstring, unknown\u003e | null = null\u003e extends CustomException\u003cTInfo\u003e {} These map nicely to HTTP status codes (400, 401, 403, 500) while remaining GraphQL-friendly.\nMiddleware: The Error Transformer Now comes the key piece: middleware that intercepts exceptions and transforms them into structured responses.\nWe use Middy, a popular middleware framework for Lambda:\nimport { MiddlewareObj } from '@middy/core'; export const exceptionHandlerMiddleware = (): MiddlewareObj =\u003e { return { onError: (request) =\u003e { const { error } = request; // Handle ValidationException if (error instanceof ValidationException) { return (request.response = { errorMessage: error.message, errorType: 'VALIDATION_EXCEPTION', errorInfo: error.info || null, }); } // Handle UnauthorizedException if (error instanceof UnauthorizedException) { return (request.response = { errorMessage: error.message, errorType: 'UNAUTHORIZED_EXCEPTION', errorInfo: error.info || null, }); } // Handle ForbiddenException if (error instanceof ForbiddenException) { return (request.response = { errorMessage: error.message, errorType: 'FORBIDDEN_EXCEPTION', errorInfo: error.info || null, }); } // Handle unknown errors return (request.response = { errorMessage: error?.message || 'INTERNAL_SERVER_ERROR', }); }, }; }; The beauty of this approach: your business logic just throws exceptions naturally, and the middleware handles the transformation. No try/catch blocks everywhere, no manual response formatting.\nPutting It Together: Lambda Handler Here‚Äôs what a complete Lambda handler looks like:\nimport middy from '@middy/core'; import { AppSyncResolverEvent } from 'aws-lambda'; import { exceptionHandlerMiddleware } from '../utils/middlewares/exceptions'; import { ValidationException, UnauthorizedException } from '../utils/exceptions/main'; export const base = async (event: AppSyncResolverEvent\u003c{ id: string }\u003e) =\u003e { // Simple validation - just throw! if (!event.arguments?.id) { throw new ValidationException('ID is required', { field: 'id', constraint: 'required', }); } // Auth check if (!event.identity?.sub) { throw new UnauthorizedException('Authentication required'); } // Business logic const item = await fetchItemFromDatabase(event.arguments.id); if (!item) { throw new ValidationException('Item not found', { field: 'id', value: event.arguments.id, }); } return item; }; // Wrap with middleware export const handler = middy(base).use(exceptionHandlerMiddleware()); Notice how clean the business logic is? No error handling boilerplate‚Äîjust throw and let the middleware handle it.\nAppSync JS Resolvers: The Critical Bridge Here‚Äôs where the magic happens. This is what transforms our structured Lambda responses into proper GraphQL errors‚Äîwithout this piece, we‚Äôd still have generic errors.\nThe key insight: Instead of letting AppSync convert Lambda errors into generic GraphQL errors, we:\nReturn structured error responses from Lambda (not thrown errors) Use AppSync JS resolvers to detect these error responses Transform them into GraphQL errors with util.error(), preserving all our structure This is how we replicate API Gateway‚Äôs error handling in GraphQL:\nimport { util } from '@aws-appsync/utils'; export function request(ctx) { return { operation: 'Invoke', invocationType: 'RequestResponse', payload: { arguments: ctx.arguments, identity: ctx.identity, info: ctx.info, source: ctx.source, stash: ctx.stash, request: ctx.request, }, }; } export function response(ctx) { const { result } = ctx; // Handle Lambda execution errors (timeout, crash, etc.) if (ctx.error) { util.error('Internal Error', 'InternalError'); } // HERE'S THE KEY: Detect our structured error responses // Lambda returned: { errorMessage, errorType, errorInfo } // We transform it to a GraphQL error while preserving structure if (result \u0026\u0026 result.errorMessage) { util.error( result.errorMessage, // Human-readable message result.errorType, // Error type (VALIDATION_EXCEPTION, etc.) result.data || null, // Partial response can be provided in case of errors result.errorInfo // Our custom context object! ); } // Success case - return the result return result; } Why This Works Without JS Resolvers (Generic GraphQL):\nLambda throws Error ‚Üí AppSync catches ‚Üí Generic GraphQL error Result: { \"errors\": [{ \"message\": \"Error\" }] } With JS Resolvers (Structured Errors):\nLambda returns { errorMessage, errorType, errorInfo } ‚Üí JS Resolver detects error response ‚Üí util.error() creates GraphQL error with full context Result: { \"errors\": [{ \"message\": \"...\", \"errorType\": \"...\", \"errorInfo\": {...} }] } The util.error() Function This is AppSync‚Äôs built-in function for creating GraphQL errors. It accepts four parameters:\nutil.error( message, // string: Human-readable error message errorType, // string: Error type identifier (like HTTP status) data, // any: Optional data to return (rarely used) errorInfo // object: Custom structured context (our secret sauce!) ); When called, it:\nImmediately stops resolver execution Sets data: null in the GraphQL response Creates an error object in the errors array Preserves our errorType and errorInfo fields This is how we get API Gateway-style structured errors in GraphQL.\nThe Final Result: API Gateway-Style GraphQL Errors After all this processing, here‚Äôs what your client receives. Notice how it combines GraphQL‚Äôs structure with REST API‚Äôs rich error context:\n{ \"data\": null, \"errors\": [ { \"message\": \"Invalid email format\", \"errorType\": \"VALIDATION_EXCEPTION\", \"errorInfo\": { \"field\": \"email\", \"constraint\": \"email\", \"receivedValue\": \"not-an-email\" }, \"path\": [\"getUser\"], \"locations\": [{ \"line\": 2, \"column\": 3 }] } ] } Compare this to a REST API Gateway response:\n{ \"statusCode\": 400, \"errorType\": \"ValidationException\", \"message\": \"Invalid email format\", \"errorInfo\": { \"field\": \"email\", \"constraint\": \"email\", \"receivedValue\": \"not-an-email\" } } We‚Äôve replicated the structure! The client gets:\n‚úÖ Error type (errorType) - Just like REST status codes, identify error categories ‚úÖ Human-readable message (message) - Clear explanation of what went wrong ‚úÖ Structured context (errorInfo) - Field-level details, constraints, and debugging data ‚úÖ GraphQL metadata (path, locations) - Bonus: know exactly where in the query it failed This is no longer a generic { \"message\": \"Error\" }. This is a production-grade error response.\nClient-Side Error Handling With structured errors, client-side handling becomes straightforward:\n// Define error types type ErrorType = 'VALIDATION_EXCEPTION' | 'UNAUTHORIZED_EXCEPTION' | 'FORBIDDEN_EXCEPTION'; interface GraphQLError { message: string; errorType?: ErrorType; errorInfo?: Record\u003cstring, unknown\u003e; path: string[]; locations: Array\u003c{ line: number; column: number }\u003e; } // Centralized error handler function handleGraphQLError(error: GraphQLError) { const { errorType, message, errorInfo } = error; switch (errorType) { case 'VALIDATION_EXCEPTION': // Show specific field errors showToast({ type: 'error', title: 'Validation Error', message: message, details: errorInfo, }); break; case 'UNAUTHORIZED_EXCEPTION': // Redirect to login redirectToLogin(); break; case 'FORBIDDEN_EXCEPTION': // Show access denied message showToast({ type: 'error', title: 'Access Denied', message: message, }); break; default: // Generic error handling showToast({ type: 'error', title: 'Error', message: message || 'An unexpected error occurred', }); } } Production Considerations Security: Don‚Äôt Leak Sensitive Information Never expose sensitive data in error messages:\n// BAD - Exposes internal details throw new ValidationException( `Database query failed: SELECT * FROM users WHERE api_key='sk_live_abc123'` ); // GOOD - Generic message with safe context throw new InternalServiceError('Database operation failed', { operation: 'query', table: 'users' }); Consider sanitizing error info in production:\nexport const exceptionHandlerMiddleware = (): MiddlewareObj =\u003e { return { onError: (request) =\u003e { const { error } = request; const isProd = process.env.NODE_ENV === 'production'; if (error instanceof ValidationException) { return (request.response = { errorMessage: error.message, errorType: 'VALIDATION_EXCEPTION', errorInfo: isProd ? sanitizeErrorInfo(error.info) : error.info, }); } // ... other handlers }, }; }; function sanitizeErrorInfo(info: any) { const sanitized = { ...info }; delete sanitized.internalId; delete sanitized.stackTrace; delete sanitized.apiKeys; return sanitized; } Benefits of This Approach After implementing this system, you‚Äôll notice several improvements:\nConsistency: Every error follows the same structure Type Safety: TypeScript catches error handling mistakes at compile time Debuggability: Rich context makes production debugging easier Developer Experience: Clear error messages and types make the API a joy to use Separation of Concerns: Business logic stays clean, error handling is centralized Client-Friendly: Structured errors are easy to handle in frontend code Common Patterns and Examples Validation Errors // Required field if (!input.email) { throw new ValidationException('Email is required', { field: 'email', constraint: 'required', }); } // Format validation if (!isValidEmail(input.email)) { throw new ValidationException('Invalid email format', { field: 'email', constraint: 'email', receivedValue: input.email, }); } // Range validation if (input.age \u003c 18 || input.age \u003e 120) { throw new ValidationException('Age must be between 18 and 120', { field: 'age', constraint: 'range', receivedValue: input.age, min: 18, max: 120, }); } Authorization Errors // Missing authentication if (!ctx.identity?.sub) { throw new UnauthorizedException('Authentication required', { reason: 'missing_token', }); } // Expired token if (isTokenExpired(token)) { throw new UnauthorizedException('Token has expired', { reason: 'token_expired', expiredAt: token.expiresAt, }); } // Insufficient permissions const hasPermission = await checkPermission(userId, 'delete:items'); if (!hasPermission) { throw new ForbiddenException('Insufficient permissions', { requiredPermission: 'delete:items', userRole: userRole, }); } Service Errors // Database errors try { await database.query(sql); } catch (error) { throw new InternalServiceError('Database operation failed', { operation: 'query', table: 'users', retryable: true, }); } // External API failures try { const response = await externalAPI.fetch(url); } catch (error) { throw new InternalServiceError('External service unavailable', { service: 'PaymentProvider', statusCode: error.statusCode, retryable: error.statusCode \u003e= 500, }); } Why This Matters Building a robust error handling system takes effort upfront, but pays dividends as your application grows. You‚Äôll spend less time debugging vague errors and more time building features. More importantly, your clients get the same quality of error handling they‚Äôd expect from a REST API, but with GraphQL‚Äôs query flexibility.\nFurther Reading AWS AppSync Documentation Middy Middleware Framework GraphQL Error Handling Best Practices AWS Lambda Error Handling Have questions or suggestions? Found this helpful? Let me know in the comments below!\n",
  "wordCount" : "2447",
  "inLanguage": "en",
  "image": "https://vishnuprasad.blog/papermod-cover.png""datePublished": "2025-11-23T18:30:00Z",
  "dateModified": "2025-11-23T18:30:00Z",
  "author":{
    "@type": "Person",
    "name": "Vishnu Prasad"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://vishnuprasad.blog/posts/appsync-error-handling/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Vishnu Prasad",
    "logo": {
      "@type": "ImageObject",
      "url": "https://vishnuprasad.blog/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://vishnuprasad.blog/" accesskey="h" title="Home (Alt + H)">Home</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://vishnuprasad.blog/posts" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="https://vishnuprasad.blog/about-me" title="AboutMe">
                    <span>AboutMe</span>
                </a>
            </li>
            <li>
                <a href="https://vishnuprasad.blog/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://vishnuprasad.blog/">Home</a>&nbsp;¬ª&nbsp;<a href="https://vishnuprasad.blog/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      Building a Robust Error Handling System for AWS AppSync APIs with Appsync JS Resolvers
    </h1>
    <div class="post-meta"><span title='2025-11-23 18:30:00 +0000 UTC'>November 23, 2025</span>&nbsp;¬∑&nbsp;12 min&nbsp;¬∑&nbsp;Vishnu Prasad

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#introduction" aria-label="Introduction">Introduction</a></li>
                <li>
                    <a href="#the-problem-graphqls-generic-error-responses" aria-label="The Problem: GraphQL&rsquo;s Generic Error Responses">The Problem: GraphQL&rsquo;s Generic Error Responses</a><ul>
                        
                <li>
                    <a href="#why-this-happens" aria-label="Why This Happens">Why This Happens</a></li>
                <li>
                    <a href="#what-were-building" aria-label="What We&rsquo;re Building">What We&rsquo;re Building</a></li></ul>
                </li>
                <li>
                    <a href="#our-solution-a-three-layer-approach" aria-label="Our Solution: A Three-Layer Approach">Our Solution: A Three-Layer Approach</a><ul>
                        
                <li>
                    <a href="#layer-1-lambda-where-errors-originate" aria-label="Layer 1: Lambda (Where Errors Originate)">Layer 1: Lambda (Where Errors Originate)</a></li>
                <li>
                    <a href="#layer-2-appsync-error-transformation" aria-label="Layer 2: AppSync (Error Transformation)">Layer 2: AppSync (Error Transformation)</a></li>
                <li>
                    <a href="#layer-3-client-error-consumption" aria-label="Layer 3: Client (Error Consumption)">Layer 3: Client (Error Consumption)</a></li>
                <li>
                    <a href="#the-complete-flow" aria-label="The Complete Flow">The Complete Flow</a></li></ul>
                </li>
                <li>
                    <a href="#building-custom-exception-classes" aria-label="Building Custom Exception Classes">Building Custom Exception Classes</a><ul>
                        
                <li>
                    <a href="#the-four-exception-types" aria-label="The Four Exception Types">The Four Exception Types</a></li></ul>
                </li>
                <li>
                    <a href="#middleware-the-error-transformer" aria-label="Middleware: The Error Transformer">Middleware: The Error Transformer</a></li>
                <li>
                    <a href="#putting-it-together-lambda-handler" aria-label="Putting It Together: Lambda Handler">Putting It Together: Lambda Handler</a></li>
                <li>
                    <a href="#appsync-js-resolvers-the-critical-bridge" aria-label="AppSync JS Resolvers: The Critical Bridge">AppSync JS Resolvers: The Critical Bridge</a><ul>
                        
                <li>
                    <a href="#why-this-works" aria-label="Why This Works">Why This Works</a></li>
                <li>
                    <a href="#the-utilerror-function" aria-label="The util.error() Function">The util.error() Function</a></li></ul>
                </li>
                <li>
                    <a href="#the-final-result-api-gateway-style-graphql-errors" aria-label="The Final Result: API Gateway-Style GraphQL Errors">The Final Result: API Gateway-Style GraphQL Errors</a></li>
                <li>
                    <a href="#client-side-error-handling" aria-label="Client-Side Error Handling">Client-Side Error Handling</a></li>
                <li>
                    <a href="#production-considerations" aria-label="Production Considerations">Production Considerations</a><ul>
                        
                <li>
                    <a href="#security-dont-leak-sensitive-information" aria-label="Security: Don&rsquo;t Leak Sensitive Information">Security: Don&rsquo;t Leak Sensitive Information</a></li></ul>
                </li>
                <li>
                    <a href="#benefits-of-this-approach" aria-label="Benefits of This Approach">Benefits of This Approach</a></li>
                <li>
                    <a href="#common-patterns-and-examples" aria-label="Common Patterns and Examples">Common Patterns and Examples</a><ul>
                        
                <li>
                    <a href="#validation-errors" aria-label="Validation Errors">Validation Errors</a></li>
                <li>
                    <a href="#authorization-errors" aria-label="Authorization Errors">Authorization Errors</a></li>
                <li>
                    <a href="#service-errors" aria-label="Service Errors">Service Errors</a></li>
                <li>
                    <a href="#why-this-matters" aria-label="Why This Matters">Why This Matters</a></li></ul>
                </li>
                <li>
                    <a href="#further-reading" aria-label="Further Reading">Further Reading</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="introduction">Introduction<a hidden class="anchor" aria-hidden="true" href="#introduction">#</a></h2>
<p>If you&rsquo;ve built REST APIs with AWS API Gateway, you know how nice it is to return structured error responses with proper HTTP status codes, error types, and detailed context. Then you switch to GraphQL with AppSync, and suddenly your beautiful error handling becomes&hellip; generic.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{ <span style="color:#f92672">&#34;errors&#34;</span>: [{ <span style="color:#f92672">&#34;message&#34;</span>: <span style="color:#e6db74">&#34;Error&#34;</span> }] }
</span></span></code></pre></div><p>That&rsquo;s it. No error types. No structured context. Just a string.</p>
<p><strong>This doesn&rsquo;t have to be the case.</strong></p>
<p>In this post, I&rsquo;ll show you how to bring API Gateway-style error handling to your GraphQL APIs using AppSync JavaScript resolvers and custom exception classes. We&rsquo;ll transform generic GraphQL errors into structured, type-safe responses that your clients can actually use.</p>
<p>By the end, you&rsquo;ll have:</p>
<ul>
<li><strong>Custom exception classes</strong> with type-safe context</li>
<li><strong>Middleware</strong> that automatically transforms errors</li>
<li><strong>AppSync JS resolvers</strong> that propagate structured errors</li>
<li><strong>Client-friendly error responses</strong> that rival REST APIs</li>
</ul>
<p>All with real, production-ready code you can implement today.</p>
<h2 id="the-problem-graphqls-generic-error-responses">The Problem: GraphQL&rsquo;s Generic Error Responses<a hidden class="anchor" aria-hidden="true" href="#the-problem-graphqls-generic-error-responses">#</a></h2>
<p>If you&rsquo;ve worked with REST APIs and AWS API Gateway, you&rsquo;re probably familiar with structured error responses:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#75715e">// REST API error response (what we want)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;statusCode&#34;</span>: <span style="color:#ae81ff">400</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;errorType&#34;</span>: <span style="color:#e6db74">&#34;ValidationException&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;message&#34;</span>: <span style="color:#e6db74">&#34;Invalid email format&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;errorInfo&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;field&#34;</span>: <span style="color:#e6db74">&#34;email&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;constraint&#34;</span>: <span style="color:#e6db74">&#34;email&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;receivedValue&#34;</span>: <span style="color:#e6db74">&#34;not-an-email&#34;</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>This is great! The client knows exactly what went wrong, which field failed validation, and why.</p>
<p>Now let&rsquo;s look at what you typically get with GraphQL/AppSync when using generic error handling:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#75715e">// Generic GraphQL error (what we&#39;re replacing)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;data&#34;</span>: <span style="color:#66d9ef">null</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;errors&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;message&#34;</span>: <span style="color:#e6db74">&#34;Error&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;path&#34;</span>: [<span style="color:#e6db74">&#34;getUser&#34;</span>],
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;locations&#34;</span>: [{ <span style="color:#f92672">&#34;line&#34;</span>: <span style="color:#ae81ff">2</span>, <span style="color:#f92672">&#34;column&#34;</span>: <span style="color:#ae81ff">3</span> }]
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>See the problem? You lose all that rich context. No error types, no additional information, just a vague message.</p>
<h3 id="why-this-happens">Why This Happens<a hidden class="anchor" aria-hidden="true" href="#why-this-happens">#</a></h3>
<p>When you throw errors in Lambda and don&rsquo;t handle them properly:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">// The problematic approach
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">handler</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">async</span> (<span style="color:#a6e22e">event</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">user</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">database</span>.<span style="color:#a6e22e">getUser</span>(<span style="color:#a6e22e">id</span>);
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">error</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// This becomes a generic GraphQL error
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(<span style="color:#e6db74">&#39;Something went wrong&#39;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><p>AppSync receives the raw error and converts it to a generic GraphQL error. You lose:</p>
<ol>
<li><strong>Error types</strong>: Can&rsquo;t differentiate between validation, auth, or server errors</li>
<li><strong>Structured context</strong>: No field names, constraint information, or additional data</li>
<li><strong>Client actionability</strong>: Frontend can&rsquo;t handle different error scenarios appropriately</li>
<li><strong>Type safety</strong>: No TypeScript interfaces, just string messages</li>
<li><strong>Debugging context</strong>: Production errors are nearly impossible to diagnose</li>
</ol>
<h3 id="what-were-building">What We&rsquo;re Building<a hidden class="anchor" aria-hidden="true" href="#what-were-building">#</a></h3>
<p>Our goal is to bring API Gateway-style error handling to GraphQL using:</p>
<ul>
<li><strong>Custom exception classes</strong> (replacing generic <code>Error</code> objects)</li>
<li><strong>Middleware-based transformation</strong> (converting exceptions to structured responses)</li>
<li><strong>AppSync JS resolvers</strong> (propagating structured errors through GraphQL)</li>
<li><strong>Type-safe error schemas</strong> (making errors as reliable as successful responses)</li>
</ul>
<p>The result? GraphQL errors that look like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;data&#34;</span>: <span style="color:#66d9ef">null</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;errors&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;message&#34;</span>: <span style="color:#e6db74">&#34;Invalid email format&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;errorType&#34;</span>: <span style="color:#e6db74">&#34;VALIDATION_EXCEPTION&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;errorInfo&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;field&#34;</span>: <span style="color:#e6db74">&#34;email&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;constraint&#34;</span>: <span style="color:#e6db74">&#34;email&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;receivedValue&#34;</span>: <span style="color:#e6db74">&#34;not-an-email&#34;</span>
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;path&#34;</span>: [<span style="color:#e6db74">&#34;getUser&#34;</span>],
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;locations&#34;</span>: [{ <span style="color:#f92672">&#34;line&#34;</span>: <span style="color:#ae81ff">2</span>, <span style="color:#f92672">&#34;column&#34;</span>: <span style="color:#ae81ff">3</span> }]
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Now we have the best of both worlds: GraphQL&rsquo;s query flexibility with REST API&rsquo;s structured error responses.</p>
<hr>
<p><strong>üìå TL;DR:</strong> We&rsquo;re replacing generic GraphQL errors with API Gateway-style structured responses by:</p>
<ol>
<li>Using custom exception classes instead of generic <code>Error</code> objects</li>
<li>Transforming exceptions to response objects via middleware</li>
<li>Using AppSync JS resolvers to propagate the structure through GraphQL&rsquo;s <code>util.error()</code></li>
</ol>
<p>Result: Clients get the same rich error context they&rsquo;d expect from a REST API.</p>
<h2 id="our-solution-a-three-layer-approach">Our Solution: A Three-Layer Approach<a hidden class="anchor" aria-hidden="true" href="#our-solution-a-three-layer-approach">#</a></h2>
<p>Our error handling system operates across three distinct layers:</p>
<h3 id="layer-1-lambda-where-errors-originate">Layer 1: Lambda (Where Errors Originate)<a hidden class="anchor" aria-hidden="true" href="#layer-1-lambda-where-errors-originate">#</a></h3>
<p>This is where your business logic lives and where most errors occur. We use:</p>
<ul>
<li><strong>Custom exception classes</strong> for type-safe error creation</li>
<li><strong>Middy middleware</strong> to intercept and transform errors</li>
<li><strong>Structured error responses</strong> that flow to AppSync</li>
</ul>
<h3 id="layer-2-appsync-error-transformation">Layer 2: AppSync (Error Transformation)<a hidden class="anchor" aria-hidden="true" href="#layer-2-appsync-error-transformation">#</a></h3>
<p>AppSync sits between your Lambda functions and clients, transforming errors into GraphQL-compliant responses:</p>
<ul>
<li><strong>JavaScript resolvers</strong> detect error responses</li>
<li><strong>Built-in utilities</strong> create proper GraphQL errors</li>
<li><strong>Automatic enrichment</strong> adds path and location information</li>
</ul>
<h3 id="layer-3-client-error-consumption">Layer 3: Client (Error Consumption)<a hidden class="anchor" aria-hidden="true" href="#layer-3-client-error-consumption">#</a></h3>
<p>Your frontend receives structured errors that are easy to handle:</p>
<ul>
<li><strong>Type-safe error interfaces</strong> in TypeScript</li>
<li><strong>Centralized error handling</strong> logic</li>
<li><strong>User-friendly error messages</strong></li>
</ul>
<h3 id="the-complete-flow">The Complete Flow<a hidden class="anchor" aria-hidden="true" href="#the-complete-flow">#</a></h3>
<p>Here&rsquo;s how an error travels through the system:</p>
<pre tabindex="0"><code>1Ô∏è‚É£ Lambda Handler
   throw new ValidationException(&#39;Invalid email&#39;, { field: &#39;email&#39; })
   ‚Üì
2Ô∏è‚É£ Middy Middleware
   Catches exception ‚Üí Returns structured response
   { errorMessage: &#39;...&#39;, errorType: &#39;...&#39;, errorInfo: {...} }
   ‚Üì
3Ô∏è‚É£ AppSync JS Resolver
   Detects error response ‚Üí Calls util.error()
   Transforms to GraphQL error format
   ‚Üì
4Ô∏è‚É£ GraphQL Response
   {
     &#34;errors&#34;: [{
       &#34;message&#34;: &#34;Invalid email&#34;,
       &#34;errorType&#34;: &#34;VALIDATION_EXCEPTION&#34;,
       &#34;errorInfo&#34;: { &#34;field&#34;: &#34;email&#34; }
     }]
   }
   ‚Üì
5Ô∏è‚É£ Client
   Receives structured error ‚Üí Shows appropriate UI
</code></pre><p><strong>Key insight:</strong> We never let AppSync see a thrown error. We always return structured response objects that the JS resolver transforms into GraphQL errors with full context.</p>
<p>Let&rsquo;s build each layer.</p>
<h2 id="building-custom-exception-classes">Building Custom Exception Classes<a hidden class="anchor" aria-hidden="true" href="#building-custom-exception-classes">#</a></h2>
<p>First, we create a base exception class that all our custom errors will extend:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-typescript" data-lang="typescript"><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CustomException</span>&lt;<span style="color:#f92672">TInfo</span> <span style="color:#a6e22e">extends</span> <span style="color:#a6e22e">Record</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">string</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">unknown</span>&gt; <span style="color:#f92672">|</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">extends</span> Error {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">readonly</span> <span style="color:#a6e22e">info</span>: <span style="color:#66d9ef">TInfo</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">constructor</span>(<span style="color:#a6e22e">message</span>: <span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">info</span>: <span style="color:#66d9ef">TInfo</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">super</span>(<span style="color:#a6e22e">message</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">info</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">info</span>;
</span></span><span style="display:flex;"><span>    Error.<span style="color:#a6e22e">captureStackTrace</span>(<span style="color:#66d9ef">this</span>, <span style="color:#66d9ef">this</span>.<span style="color:#66d9ef">constructor</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>The magic here is the generic <code>TInfo</code> parameter. This lets us attach type-safe context to any error:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-typescript" data-lang="typescript"><span style="display:flex;"><span><span style="color:#75715e">// Define what information this error carries
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">UserValidationError</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">field</span>: <span style="color:#66d9ef">string</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">constraint</span>: <span style="color:#66d9ef">string</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">receivedValue</span>: <span style="color:#66d9ef">unknown</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">allowedValues?</span>: <span style="color:#66d9ef">string</span>[];
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Throw with type-safe context
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">ValidationException</span>&lt;<span style="color:#f92672">UserValidationError</span>&gt;(<span style="color:#e6db74">&#39;Invalid user role&#39;</span>, {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">field</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;role&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">constraint</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;enum&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">receivedValue</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;super_admin&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">allowedValues</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#39;user&#39;</span>, <span style="color:#e6db74">&#39;admin&#39;</span>, <span style="color:#e6db74">&#39;moderator&#39;</span>],
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><p>TypeScript now knows exactly what&rsquo;s in <code>error.info</code>‚Äîno guessing, no casting.</p>
<h3 id="the-four-exception-types">The Four Exception Types<a hidden class="anchor" aria-hidden="true" href="#the-four-exception-types">#</a></h3>
<p>We define four core exception types that cover most scenarios:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-typescript" data-lang="typescript"><span style="display:flex;"><span><span style="color:#75715e">// 1. ValidationException - Bad input from client
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ValidationException</span>&lt;<span style="color:#f92672">TInfo</span> <span style="color:#a6e22e">extends</span> <span style="color:#a6e22e">Record</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">string</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">unknown</span>&gt; <span style="color:#f92672">|</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">CustomException</span>&lt;<span style="color:#f92672">TInfo</span>&gt; {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 2. UnauthorizedException - Missing or invalid auth
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UnauthorizedException</span>&lt;<span style="color:#f92672">TInfo</span> <span style="color:#a6e22e">extends</span> <span style="color:#a6e22e">Record</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">string</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">unknown</span>&gt; <span style="color:#f92672">|</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">CustomException</span>&lt;<span style="color:#f92672">TInfo</span>&gt; {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 3. ForbiddenException - Valid auth but insufficient permissions
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ForbiddenException</span>&lt;<span style="color:#f92672">TInfo</span> <span style="color:#a6e22e">extends</span> <span style="color:#a6e22e">Record</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">string</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">unknown</span>&gt; <span style="color:#f92672">|</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">CustomException</span>&lt;<span style="color:#f92672">TInfo</span>&gt; {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 4. InternalServiceError - Server-side failures
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">InternalServiceError</span>&lt;<span style="color:#f92672">TInfo</span> <span style="color:#a6e22e">extends</span> <span style="color:#a6e22e">Record</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">string</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">unknown</span>&gt; <span style="color:#f92672">|</span> <span style="color:#66d9ef">null</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">CustomException</span>&lt;<span style="color:#f92672">TInfo</span>&gt; {}
</span></span></code></pre></div><p>These map nicely to HTTP status codes (400, 401, 403, 500) while remaining GraphQL-friendly.</p>
<h2 id="middleware-the-error-transformer">Middleware: The Error Transformer<a hidden class="anchor" aria-hidden="true" href="#middleware-the-error-transformer">#</a></h2>
<p>Now comes the key piece: middleware that intercepts exceptions and transforms them into structured responses.</p>
<p>We use <a href="https://middy.js.org/">Middy</a>, a popular middleware framework for Lambda:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-typescript" data-lang="typescript"><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">MiddlewareObj</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#39;@middy/core&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">exceptionHandlerMiddleware</span> <span style="color:#f92672">=</span> ()<span style="color:#f92672">:</span> <span style="color:#a6e22e">MiddlewareObj</span> <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">onError</span><span style="color:#f92672">:</span> (<span style="color:#a6e22e">request</span>) <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">error</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">request</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// Handle ValidationException
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">error</span> <span style="color:#66d9ef">instanceof</span> <span style="color:#a6e22e">ValidationException</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> (<span style="color:#a6e22e">request</span>.<span style="color:#a6e22e">response</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">errorMessage</span>: <span style="color:#66d9ef">error.message</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">errorType</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;VALIDATION_EXCEPTION&#39;</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">errorInfo</span>: <span style="color:#66d9ef">error.info</span> <span style="color:#f92672">||</span> <span style="color:#66d9ef">null</span>,
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// Handle UnauthorizedException
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">error</span> <span style="color:#66d9ef">instanceof</span> <span style="color:#a6e22e">UnauthorizedException</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> (<span style="color:#a6e22e">request</span>.<span style="color:#a6e22e">response</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">errorMessage</span>: <span style="color:#66d9ef">error.message</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">errorType</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;UNAUTHORIZED_EXCEPTION&#39;</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">errorInfo</span>: <span style="color:#66d9ef">error.info</span> <span style="color:#f92672">||</span> <span style="color:#66d9ef">null</span>,
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// Handle ForbiddenException
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">error</span> <span style="color:#66d9ef">instanceof</span> <span style="color:#a6e22e">ForbiddenException</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> (<span style="color:#a6e22e">request</span>.<span style="color:#a6e22e">response</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">errorMessage</span>: <span style="color:#66d9ef">error.message</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">errorType</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;FORBIDDEN_EXCEPTION&#39;</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">errorInfo</span>: <span style="color:#66d9ef">error.info</span> <span style="color:#f92672">||</span> <span style="color:#66d9ef">null</span>,
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// Handle unknown errors
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#66d9ef">return</span> (<span style="color:#a6e22e">request</span>.<span style="color:#a6e22e">response</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">errorMessage</span>: <span style="color:#66d9ef">error?.message</span> <span style="color:#f92672">||</span> <span style="color:#e6db74">&#39;INTERNAL_SERVER_ERROR&#39;</span>,
</span></span><span style="display:flex;"><span>      });
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>};
</span></span></code></pre></div><p>The beauty of this approach: your business logic just throws exceptions naturally, and the middleware handles the transformation. No <code>try/catch</code> blocks everywhere, no manual response formatting.</p>
<h2 id="putting-it-together-lambda-handler">Putting It Together: Lambda Handler<a hidden class="anchor" aria-hidden="true" href="#putting-it-together-lambda-handler">#</a></h2>
<p>Here&rsquo;s what a complete Lambda handler looks like:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-typescript" data-lang="typescript"><span style="display:flex;"><span><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">middy</span> <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#39;@middy/core&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">AppSyncResolverEvent</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#39;aws-lambda&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">exceptionHandlerMiddleware</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#39;../utils/middlewares/exceptions&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">ValidationException</span>, <span style="color:#a6e22e">UnauthorizedException</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#39;../utils/exceptions/main&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">base</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">async</span> (<span style="color:#a6e22e">event</span>: <span style="color:#66d9ef">AppSyncResolverEvent</span><span style="color:#f92672">&lt;</span>{ <span style="color:#a6e22e">id</span>: <span style="color:#66d9ef">string</span> }<span style="color:#f92672">&gt;</span>) <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Simple validation - just throw!
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">event</span>.<span style="color:#a6e22e">arguments</span><span style="color:#f92672">?</span>.<span style="color:#a6e22e">id</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">ValidationException</span>(<span style="color:#e6db74">&#39;ID is required&#39;</span>, {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">field</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;id&#39;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">constraint</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;required&#39;</span>,
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Auth check
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">event</span>.<span style="color:#a6e22e">identity</span><span style="color:#f92672">?</span>.<span style="color:#a6e22e">sub</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">UnauthorizedException</span>(<span style="color:#e6db74">&#39;Authentication required&#39;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Business logic
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">item</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">fetchItemFromDatabase</span>(<span style="color:#a6e22e">event</span>.<span style="color:#a6e22e">arguments</span>.<span style="color:#a6e22e">id</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">item</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">ValidationException</span>(<span style="color:#e6db74">&#39;Item not found&#39;</span>, {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">field</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;id&#39;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">value</span>: <span style="color:#66d9ef">event.arguments.id</span>,
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">item</span>;
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Wrap with middleware
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">handler</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">middy</span>(<span style="color:#a6e22e">base</span>).<span style="color:#a6e22e">use</span>(<span style="color:#a6e22e">exceptionHandlerMiddleware</span>());
</span></span></code></pre></div><p>Notice how clean the business logic is? No error handling boilerplate‚Äîjust throw and let the middleware handle it.</p>
<h2 id="appsync-js-resolvers-the-critical-bridge">AppSync JS Resolvers: The Critical Bridge<a hidden class="anchor" aria-hidden="true" href="#appsync-js-resolvers-the-critical-bridge">#</a></h2>
<p>Here&rsquo;s where the magic happens. This is what transforms our structured Lambda responses into proper GraphQL errors‚Äîwithout this piece, we&rsquo;d still have generic errors.</p>
<p><strong>The key insight:</strong> Instead of letting AppSync convert Lambda errors into generic GraphQL errors, we:</p>
<ol>
<li>Return structured error <strong>responses</strong> from Lambda (not thrown errors)</li>
<li>Use AppSync JS resolvers to detect these error responses</li>
<li>Transform them into GraphQL errors with <code>util.error()</code>, preserving all our structure</li>
</ol>
<p>This is how we replicate API Gateway&rsquo;s error handling in GraphQL:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">util</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;@aws-appsync/utils&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">request</span>(<span style="color:#a6e22e">ctx</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">operation</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Invoke&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">invocationType</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;RequestResponse&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">payload</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">arguments</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">arguments</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">identity</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">identity</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">info</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">info</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">source</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">source</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">stash</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">stash</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">request</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">request</span>,
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">response</span>(<span style="color:#a6e22e">ctx</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">result</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">ctx</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Handle Lambda execution errors (timeout, crash, etc.)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">error</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">util</span>.<span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#39;Internal Error&#39;</span>, <span style="color:#e6db74">&#39;InternalError&#39;</span>);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// HERE&#39;S THE KEY: Detect our structured error responses
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">// Lambda returned: { errorMessage, errorType, errorInfo }
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">// We transform it to a GraphQL error while preserving structure
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">result</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">errorMessage</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">util</span>.<span style="color:#a6e22e">error</span>(
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">errorMessage</span>,  <span style="color:#75715e">// Human-readable message
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">errorType</span>,     <span style="color:#75715e">// Error type (VALIDATION_EXCEPTION, etc.)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">data</span> <span style="color:#f92672">||</span> <span style="color:#66d9ef">null</span>,  <span style="color:#75715e">// Partial response can be provided in case of errors
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#a6e22e">result</span>.<span style="color:#a6e22e">errorInfo</span>      <span style="color:#75715e">// Our custom context object!
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    );
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Success case - return the result
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">result</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="why-this-works">Why This Works<a hidden class="anchor" aria-hidden="true" href="#why-this-works">#</a></h3>
<p><strong>Without JS Resolvers (Generic GraphQL):</strong></p>
<pre tabindex="0"><code>Lambda throws Error ‚Üí AppSync catches ‚Üí Generic GraphQL error
Result: { &#34;errors&#34;: [{ &#34;message&#34;: &#34;Error&#34; }] }
</code></pre><p><strong>With JS Resolvers (Structured Errors):</strong></p>
<pre tabindex="0"><code>Lambda returns { errorMessage, errorType, errorInfo }
‚Üí JS Resolver detects error response
‚Üí util.error() creates GraphQL error with full context
Result: { &#34;errors&#34;: [{ &#34;message&#34;: &#34;...&#34;, &#34;errorType&#34;: &#34;...&#34;, &#34;errorInfo&#34;: {...} }] }
</code></pre><h3 id="the-utilerror-function">The util.error() Function<a hidden class="anchor" aria-hidden="true" href="#the-utilerror-function">#</a></h3>
<p>This is AppSync&rsquo;s built-in function for creating GraphQL errors. It accepts four parameters:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">util</span>.<span style="color:#a6e22e">error</span>(
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">message</span>,    <span style="color:#75715e">// string: Human-readable error message
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">errorType</span>,  <span style="color:#75715e">// string: Error type identifier (like HTTP status)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">data</span>,       <span style="color:#75715e">// any: Optional data to return (rarely used)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">errorInfo</span>   <span style="color:#75715e">// object: Custom structured context (our secret sauce!)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>);
</span></span></code></pre></div><p>When called, it:</p>
<ul>
<li>Immediately stops resolver execution</li>
<li>Sets <code>data: null</code> in the GraphQL response</li>
<li>Creates an error object in the <code>errors</code> array</li>
<li><strong>Preserves our errorType and errorInfo fields</strong></li>
</ul>
<p>This is how we get API Gateway-style structured errors in GraphQL.</p>
<h2 id="the-final-result-api-gateway-style-graphql-errors">The Final Result: API Gateway-Style GraphQL Errors<a hidden class="anchor" aria-hidden="true" href="#the-final-result-api-gateway-style-graphql-errors">#</a></h2>
<p>After all this processing, here&rsquo;s what your client receives. Notice how it combines GraphQL&rsquo;s structure with REST API&rsquo;s rich error context:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;data&#34;</span>: <span style="color:#66d9ef">null</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;errors&#34;</span>: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;message&#34;</span>: <span style="color:#e6db74">&#34;Invalid email format&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;errorType&#34;</span>: <span style="color:#e6db74">&#34;VALIDATION_EXCEPTION&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;errorInfo&#34;</span>: {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;field&#34;</span>: <span style="color:#e6db74">&#34;email&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;constraint&#34;</span>: <span style="color:#e6db74">&#34;email&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&#34;receivedValue&#34;</span>: <span style="color:#e6db74">&#34;not-an-email&#34;</span>
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;path&#34;</span>: [<span style="color:#e6db74">&#34;getUser&#34;</span>],
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&#34;locations&#34;</span>: [{ <span style="color:#f92672">&#34;line&#34;</span>: <span style="color:#ae81ff">2</span>, <span style="color:#f92672">&#34;column&#34;</span>: <span style="color:#ae81ff">3</span> }]
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  ]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>Compare this to a REST API Gateway response:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;statusCode&#34;</span>: <span style="color:#ae81ff">400</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;errorType&#34;</span>: <span style="color:#e6db74">&#34;ValidationException&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;message&#34;</span>: <span style="color:#e6db74">&#34;Invalid email format&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;errorInfo&#34;</span>: {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;field&#34;</span>: <span style="color:#e6db74">&#34;email&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;constraint&#34;</span>: <span style="color:#e6db74">&#34;email&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;receivedValue&#34;</span>: <span style="color:#e6db74">&#34;not-an-email&#34;</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>We&rsquo;ve replicated the structure! The client gets:</p>
<ul>
<li>‚úÖ <strong>Error type</strong> (<code>errorType</code>) - Just like REST status codes, identify error categories</li>
<li>‚úÖ <strong>Human-readable message</strong> (<code>message</code>) - Clear explanation of what went wrong</li>
<li>‚úÖ <strong>Structured context</strong> (<code>errorInfo</code>) - Field-level details, constraints, and debugging data</li>
<li>‚úÖ <strong>GraphQL metadata</strong> (<code>path</code>, <code>locations</code>) - Bonus: know exactly where in the query it failed</li>
</ul>
<p>This is no longer a generic <code>{ &quot;message&quot;: &quot;Error&quot; }</code>. This is a production-grade error response.</p>
<h2 id="client-side-error-handling">Client-Side Error Handling<a hidden class="anchor" aria-hidden="true" href="#client-side-error-handling">#</a></h2>
<p>With structured errors, client-side handling becomes straightforward:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-typescript" data-lang="typescript"><span style="display:flex;"><span><span style="color:#75715e">// Define error types
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">ErrorType</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;VALIDATION_EXCEPTION&#39;</span> <span style="color:#f92672">|</span> <span style="color:#e6db74">&#39;UNAUTHORIZED_EXCEPTION&#39;</span> <span style="color:#f92672">|</span> <span style="color:#e6db74">&#39;FORBIDDEN_EXCEPTION&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">GraphQLError</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">message</span>: <span style="color:#66d9ef">string</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">errorType?</span>: <span style="color:#66d9ef">ErrorType</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">errorInfo?</span>: <span style="color:#66d9ef">Record</span>&lt;<span style="color:#f92672">string</span><span style="color:#960050;background-color:#1e0010">,</span> <span style="color:#a6e22e">unknown</span>&gt;;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">path</span>: <span style="color:#66d9ef">string</span>[];
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">locations</span>: <span style="color:#66d9ef">Array</span><span style="color:#f92672">&lt;</span>{ <span style="color:#a6e22e">line</span>: <span style="color:#66d9ef">number</span>; <span style="color:#a6e22e">column</span>: <span style="color:#66d9ef">number</span> }<span style="color:#f92672">&gt;</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Centralized error handler
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">handleGraphQLError</span>(<span style="color:#a6e22e">error</span>: <span style="color:#66d9ef">GraphQLError</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">errorType</span>, <span style="color:#a6e22e">message</span>, <span style="color:#a6e22e">errorInfo</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">error</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">switch</span> (<span style="color:#a6e22e">errorType</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;VALIDATION_EXCEPTION&#39;</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// Show specific field errors
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#a6e22e">showToast</span>({
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">type</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;error&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">title</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Validation Error&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">message</span>: <span style="color:#66d9ef">message</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">details</span>: <span style="color:#66d9ef">errorInfo</span>,
</span></span><span style="display:flex;"><span>      });
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;UNAUTHORIZED_EXCEPTION&#39;</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// Redirect to login
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#a6e22e">redirectToLogin</span>();
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#39;FORBIDDEN_EXCEPTION&#39;</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// Show access denied message
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#a6e22e">showToast</span>({
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">type</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;error&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">title</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Access Denied&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">message</span>: <span style="color:#66d9ef">message</span>,
</span></span><span style="display:flex;"><span>      });
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">default</span><span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// Generic error handling
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#a6e22e">showToast</span>({
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">type</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;error&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">title</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Error&#39;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">message</span>: <span style="color:#66d9ef">message</span> <span style="color:#f92672">||</span> <span style="color:#e6db74">&#39;An unexpected error occurred&#39;</span>,
</span></span><span style="display:flex;"><span>      });
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="production-considerations">Production Considerations<a hidden class="anchor" aria-hidden="true" href="#production-considerations">#</a></h2>
<h3 id="security-dont-leak-sensitive-information">Security: Don&rsquo;t Leak Sensitive Information<a hidden class="anchor" aria-hidden="true" href="#security-dont-leak-sensitive-information">#</a></h3>
<p>Never expose sensitive data in error messages:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-typescript" data-lang="typescript"><span style="display:flex;"><span><span style="color:#75715e">// BAD - Exposes internal details
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">ValidationException</span>(
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">`Database query failed: SELECT * FROM users WHERE api_key=&#39;sk_live_abc123&#39;`</span>
</span></span><span style="display:flex;"><span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// GOOD - Generic message with safe context
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">InternalServiceError</span>(<span style="color:#e6db74">&#39;Database operation failed&#39;</span>, {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">operation</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;query&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">table</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;users&#39;</span>
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><p>Consider sanitizing error info in production:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-typescript" data-lang="typescript"><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">exceptionHandlerMiddleware</span> <span style="color:#f92672">=</span> ()<span style="color:#f92672">:</span> <span style="color:#a6e22e">MiddlewareObj</span> <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">onError</span><span style="color:#f92672">:</span> (<span style="color:#a6e22e">request</span>) <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">error</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">request</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">isProd</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">process</span>.<span style="color:#a6e22e">env</span>.<span style="color:#a6e22e">NODE_ENV</span> <span style="color:#f92672">===</span> <span style="color:#e6db74">&#39;production&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">error</span> <span style="color:#66d9ef">instanceof</span> <span style="color:#a6e22e">ValidationException</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> (<span style="color:#a6e22e">request</span>.<span style="color:#a6e22e">response</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">errorMessage</span>: <span style="color:#66d9ef">error.message</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">errorType</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;VALIDATION_EXCEPTION&#39;</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">errorInfo</span>: <span style="color:#66d9ef">isProd</span> <span style="color:#f92672">?</span> <span style="color:#a6e22e">sanitizeErrorInfo</span>(<span style="color:#a6e22e">error</span>.<span style="color:#a6e22e">info</span>) <span style="color:#f92672">:</span> <span style="color:#a6e22e">error</span>.<span style="color:#a6e22e">info</span>,
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>      <span style="color:#75715e">// ... other handlers
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    },
</span></span><span style="display:flex;"><span>  };
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">sanitizeErrorInfo</span>(<span style="color:#a6e22e">info</span>: <span style="color:#66d9ef">any</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sanitized</span> <span style="color:#f92672">=</span> { ...<span style="color:#a6e22e">info</span> };
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">delete</span> <span style="color:#a6e22e">sanitized</span>.<span style="color:#a6e22e">internalId</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">delete</span> <span style="color:#a6e22e">sanitized</span>.<span style="color:#a6e22e">stackTrace</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">delete</span> <span style="color:#a6e22e">sanitized</span>.<span style="color:#a6e22e">apiKeys</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">sanitized</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="benefits-of-this-approach">Benefits of This Approach<a hidden class="anchor" aria-hidden="true" href="#benefits-of-this-approach">#</a></h2>
<p>After implementing this system, you&rsquo;ll notice several improvements:</p>
<ol>
<li><strong>Consistency</strong>: Every error follows the same structure</li>
<li><strong>Type Safety</strong>: TypeScript catches error handling mistakes at compile time</li>
<li><strong>Debuggability</strong>: Rich context makes production debugging easier</li>
<li><strong>Developer Experience</strong>: Clear error messages and types make the API a joy to use</li>
<li><strong>Separation of Concerns</strong>: Business logic stays clean, error handling is centralized</li>
<li><strong>Client-Friendly</strong>: Structured errors are easy to handle in frontend code</li>
</ol>
<h2 id="common-patterns-and-examples">Common Patterns and Examples<a hidden class="anchor" aria-hidden="true" href="#common-patterns-and-examples">#</a></h2>
<h3 id="validation-errors">Validation Errors<a hidden class="anchor" aria-hidden="true" href="#validation-errors">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-typescript" data-lang="typescript"><span style="display:flex;"><span><span style="color:#75715e">// Required field
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">input</span>.<span style="color:#a6e22e">email</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">ValidationException</span>(<span style="color:#e6db74">&#39;Email is required&#39;</span>, {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">field</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;email&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">constraint</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;required&#39;</span>,
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Format validation
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">isValidEmail</span>(<span style="color:#a6e22e">input</span>.<span style="color:#a6e22e">email</span>)) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">ValidationException</span>(<span style="color:#e6db74">&#39;Invalid email format&#39;</span>, {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">field</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;email&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">constraint</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;email&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">receivedValue</span>: <span style="color:#66d9ef">input.email</span>,
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Range validation
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">input</span>.<span style="color:#a6e22e">age</span> <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">18</span> <span style="color:#f92672">||</span> <span style="color:#a6e22e">input</span>.<span style="color:#a6e22e">age</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">120</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">ValidationException</span>(<span style="color:#e6db74">&#39;Age must be between 18 and 120&#39;</span>, {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">field</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;age&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">constraint</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;range&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">receivedValue</span>: <span style="color:#66d9ef">input.age</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">min</span>: <span style="color:#66d9ef">18</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">max</span>: <span style="color:#66d9ef">120</span>,
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="authorization-errors">Authorization Errors<a hidden class="anchor" aria-hidden="true" href="#authorization-errors">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-typescript" data-lang="typescript"><span style="display:flex;"><span><span style="color:#75715e">// Missing authentication
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">identity</span><span style="color:#f92672">?</span>.<span style="color:#a6e22e">sub</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">UnauthorizedException</span>(<span style="color:#e6db74">&#39;Authentication required&#39;</span>, {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">reason</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;missing_token&#39;</span>,
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Expired token
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">isTokenExpired</span>(<span style="color:#a6e22e">token</span>)) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">UnauthorizedException</span>(<span style="color:#e6db74">&#39;Token has expired&#39;</span>, {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">reason</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;token_expired&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">expiredAt</span>: <span style="color:#66d9ef">token.expiresAt</span>,
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Insufficient permissions
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">hasPermission</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">checkPermission</span>(<span style="color:#a6e22e">userId</span>, <span style="color:#e6db74">&#39;delete:items&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">hasPermission</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">ForbiddenException</span>(<span style="color:#e6db74">&#39;Insufficient permissions&#39;</span>, {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">requiredPermission</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;delete:items&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">userRole</span>: <span style="color:#66d9ef">userRole</span>,
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="service-errors">Service Errors<a hidden class="anchor" aria-hidden="true" href="#service-errors">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-typescript" data-lang="typescript"><span style="display:flex;"><span><span style="color:#75715e">// Database errors
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">database</span>.<span style="color:#a6e22e">query</span>(<span style="color:#a6e22e">sql</span>);
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">error</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">InternalServiceError</span>(<span style="color:#e6db74">&#39;Database operation failed&#39;</span>, {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">operation</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;query&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">table</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;users&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">retryable</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// External API failures
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">response</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">await</span> <span style="color:#a6e22e">externalAPI</span>.<span style="color:#a6e22e">fetch</span>(<span style="color:#a6e22e">url</span>);
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">error</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">InternalServiceError</span>(<span style="color:#e6db74">&#39;External service unavailable&#39;</span>, {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">service</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;PaymentProvider&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">statusCode</span>: <span style="color:#66d9ef">error.statusCode</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">retryable</span>: <span style="color:#66d9ef">error.statusCode</span> <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">500</span>,
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="why-this-matters">Why This Matters<a hidden class="anchor" aria-hidden="true" href="#why-this-matters">#</a></h3>
<p>Building a robust error handling system takes effort upfront, but pays dividends as your application grows. You&rsquo;ll spend less time debugging vague errors and more time building features. More importantly, <strong>your clients get the same quality of error handling they&rsquo;d expect from a REST API</strong>, but with GraphQL&rsquo;s query flexibility.</p>
<h2 id="further-reading">Further Reading<a hidden class="anchor" aria-hidden="true" href="#further-reading">#</a></h2>
<ul>
<li><a href="https://docs.aws.amazon.com/appsync/">AWS AppSync Documentation</a></li>
<li><a href="https://middy.js.org/">Middy Middleware Framework</a></li>
<li><a href="https://spec.graphql.org/October2021/#sec-Errors">GraphQL Error Handling Best Practices</a></li>
<li><a href="https://docs.aws.amazon.com/lambda/latest/dg/nodejs-exceptions.html">AWS Lambda Error Handling</a></li>
</ul>
<hr>
<p><em>Have questions or suggestions? Found this helpful? Let me know in the comments below!</em></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://vishnuprasad.blog/tags/aws/">Aws</a></li>
      <li><a href="https://vishnuprasad.blog/tags/serverless/">Serverless</a></li>
      <li><a href="https://vishnuprasad.blog/tags/appsync/">Appsync</a></li>
      <li><a href="https://vishnuprasad.blog/tags/lambda/">Lambda</a></li>
      <li><a href="https://vishnuprasad.blog/tags/error/">Error</a></li>
      <li><a href="https://vishnuprasad.blog/tags/error-handling/">Error Handling</a></li>
      <li><a href="https://vishnuprasad.blog/tags/appsync-error-handling/">Appsync Error Handling</a></li>
      <li><a href="https://vishnuprasad.blog/tags/aws-appsync/">Aws Appsync</a></li>
      <li><a href="https://vishnuprasad.blog/tags/best-practice/">Best Practice</a></li>
      <li><a href="https://vishnuprasad.blog/tags/appsync-error-handling-best-practices/">Appsync Error Handling Best Practices</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://vishnuprasad.blog/posts/github-multiple-account-management-cli/">
    <span class="title">¬´ Prev</span>
    <br>
    <span>Managing Multiple GitHub Accounts from the CLI</span>
  </a>
  <a class="next" href="https://vishnuprasad.blog/posts/cloud-watch-logs-field-level-indexes/">
    <span class="title">Next ¬ª</span>
    <br>
    <span>Optimizing Amazon CloudWatch Insights Queries With Field Level Indexes for Efficient Log Analytics</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Building a Robust Error Handling System for AWS AppSync APIs with Appsync JS Resolvers on x"
            href="https://x.com/intent/tweet/?text=Building%20a%20Robust%20Error%20Handling%20System%20for%20AWS%20AppSync%20APIs%20with%20Appsync%20JS%20Resolvers&amp;url=https%3a%2f%2fvishnuprasad.blog%2fposts%2fappsync-error-handling%2f&amp;hashtags=aws%2cserverless%2cappsync%2clambda%2cerror%2cerrorhandling%2cappsyncerrorhandling%2cawsappsync%2cbestpractice%2cappsyncerrorhandlingbestpractices">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Building a Robust Error Handling System for AWS AppSync APIs with Appsync JS Resolvers on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fvishnuprasad.blog%2fposts%2fappsync-error-handling%2f&amp;title=Building%20a%20Robust%20Error%20Handling%20System%20for%20AWS%20AppSync%20APIs%20with%20Appsync%20JS%20Resolvers&amp;summary=Building%20a%20Robust%20Error%20Handling%20System%20for%20AWS%20AppSync%20APIs%20with%20Appsync%20JS%20Resolvers&amp;source=https%3a%2f%2fvishnuprasad.blog%2fposts%2fappsync-error-handling%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Building a Robust Error Handling System for AWS AppSync APIs with Appsync JS Resolvers on reddit"
            href="https://reddit.com/submit?url=https%3a%2f%2fvishnuprasad.blog%2fposts%2fappsync-error-handling%2f&title=Building%20a%20Robust%20Error%20Handling%20System%20for%20AWS%20AppSync%20APIs%20with%20Appsync%20JS%20Resolvers">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Building a Robust Error Handling System for AWS AppSync APIs with Appsync JS Resolvers on facebook"
            href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fvishnuprasad.blog%2fposts%2fappsync-error-handling%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Building a Robust Error Handling System for AWS AppSync APIs with Appsync JS Resolvers on whatsapp"
            href="https://api.whatsapp.com/send?text=Building%20a%20Robust%20Error%20Handling%20System%20for%20AWS%20AppSync%20APIs%20with%20Appsync%20JS%20Resolvers%20-%20https%3a%2f%2fvishnuprasad.blog%2fposts%2fappsync-error-handling%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Building a Robust Error Handling System for AWS AppSync APIs with Appsync JS Resolvers on telegram"
            href="https://telegram.me/share/url?text=Building%20a%20Robust%20Error%20Handling%20System%20for%20AWS%20AppSync%20APIs%20with%20Appsync%20JS%20Resolvers&amp;url=https%3a%2f%2fvishnuprasad.blog%2fposts%2fappsync-error-handling%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Building a Robust Error Handling System for AWS AppSync APIs with Appsync JS Resolvers on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=Building%20a%20Robust%20Error%20Handling%20System%20for%20AWS%20AppSync%20APIs%20with%20Appsync%20JS%20Resolvers&u=https%3a%2f%2fvishnuprasad.blog%2fposts%2fappsync-error-handling%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2026 <a href="https://vishnuprasad.blog/">Vishnu Prasad</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
